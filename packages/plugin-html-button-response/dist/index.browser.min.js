var jsPsychHtmlButtonResponse = (function (n) {
  "use strict";
  var y = {
    name: "@jspsych/plugin-html-button-response",
    version: "2.0.0",
    description: "jsPsych plugin for displaying a stimulus and getting a button response",
    type: "module",
    main: "dist/index.cjs",
    exports: { import: "./dist/index.js", require: "./dist/index.cjs" },
    typings: "dist/index.d.ts",
    unpkg: "dist/index.browser.min.js",
    files: ["src", "dist"],
    source: "src/index.ts",
    scripts: {
      test: "jest",
      "test:watch": "npm test -- --watch",
      tsc: "tsc",
      build: "rollup --config",
      "build:watch": "npm run build -- --watch",
    },
    repository: {
      type: "git",
      url: "git+https://github.com/jspsych/jsPsych.git",
      directory: "packages/plugin-html-button-response",
    },
    author: "Josh de Leeuw",
    license: "MIT",
    bugs: { url: "https://github.com/jspsych/jsPsych/issues" },
    homepage: "https://www.jspsych.org/latest/plugins/html-button-response",
    peerDependencies: { jspsych: ">=7.1.0" },
    devDependencies: { "@jspsych/config": "^3.0.0", "@jspsych/test-utils": "^1.2.0" },
  };
  const g = {
    name: "html-button-response",
    version: y.version,
    parameters: {
      stimulus: { type: n.ParameterType.HTML_STRING, default: void 0 },
      choices: { type: n.ParameterType.STRING, default: void 0, array: !0 },
      button_html: {
        type: n.ParameterType.FUNCTION,
        default: function (p, e) {
          return `<button class="jspsych-btn">${p}</button>`;
        },
      },
      prompt: { type: n.ParameterType.HTML_STRING, default: null },
      stimulus_duration: { type: n.ParameterType.INT, default: null },
      trial_duration: { type: n.ParameterType.INT, default: null },
      button_layout: { type: n.ParameterType.STRING, default: "grid" },
      grid_rows: { type: n.ParameterType.INT, default: 1 },
      grid_columns: { type: n.ParameterType.INT, default: null },
      response_ends_trial: { type: n.ParameterType.BOOL, default: !0 },
      enable_button_after: { type: n.ParameterType.INT, default: 0 },
    },
    data: {
      rt: { type: n.ParameterType.INT },
      response: { type: n.ParameterType.INT },
      stimulus: { type: n.ParameterType.HTML_STRING },
    },
  };
  class c {
    constructor(e) {
      this.jsPsych = e;
    }
    trial(e, t) {
      const i = document.createElement("div");
      (i.id = "jspsych-html-button-response-stimulus"),
        (i.innerHTML = t.stimulus),
        e.appendChild(i);
      const s = document.createElement("div");
      if (((s.id = "jspsych-html-button-response-btngroup"), t.button_layout === "grid")) {
        if (
          (s.classList.add("jspsych-btn-group-grid"),
          t.grid_rows === null && t.grid_columns === null)
        )
          throw new Error(
            "You cannot set `grid_rows` to `null` without providing a value for `grid_columns`."
          );
        const r =
            t.grid_columns === null ? Math.ceil(t.choices.length / t.grid_rows) : t.grid_columns,
          a = t.grid_rows === null ? Math.ceil(t.choices.length / t.grid_columns) : t.grid_rows;
        (s.style.gridTemplateColumns = `repeat(${r}, 1fr)`),
          (s.style.gridTemplateRows = `repeat(${a}, 1fr)`);
      } else t.button_layout === "flex" && s.classList.add("jspsych-btn-group-flex");
      for (const [r, a] of t.choices.entries()) {
        s.insertAdjacentHTML("beforeend", t.button_html(a, r));
        const u = s.lastChild;
        (u.dataset.choice = r.toString()),
          u.addEventListener("click", () => {
            b(r);
          });
      }
      e.appendChild(s), t.prompt !== null && e.insertAdjacentHTML("beforeend", t.prompt);
      var l = performance.now(),
        o = { rt: null, button: null };
      const m = () => {
        var r = { rt: o.rt, stimulus: t.stimulus, response: o.button };
        this.jsPsych.finishTrial(r);
      };
      function b(r) {
        var a = performance.now(),
          u = Math.round(a - l);
        (o.button = parseInt(r)), (o.rt = u), i.classList.add("responded");
        for (const _ of s.children) _.setAttribute("disabled", "disabled");
        t.response_ends_trial && m();
      }
      if (
        (t.stimulus_duration !== null &&
          this.jsPsych.pluginAPI.setTimeout(() => {
            i.style.visibility = "hidden";
          }, t.stimulus_duration),
        t.enable_button_after > 0)
      ) {
        for (
          var h = document.querySelectorAll(".jspsych-html-button-response-button button"), d = 0;
          d < h.length;
          d++
        )
          h[d].setAttribute("disabled", "disabled");
        this.jsPsych.pluginAPI.setTimeout(() => {
          for (
            var r = document.querySelectorAll(".jspsych-html-button-response-button button"), a = 0;
            a < r.length;
            a++
          )
            r[a].removeAttribute("disabled");
        }, t.enable_button_after);
      }
      t.trial_duration !== null && this.jsPsych.pluginAPI.setTimeout(m, t.trial_duration);
    }
    simulate(e, t, i, s) {
      t == "data-only" && (s(), this.simulate_data_only(e, i)),
        t == "visual" && this.simulate_visual(e, i, s);
    }
    create_simulation_data(e, t) {
      const i = {
          stimulus: e.stimulus,
          rt:
            this.jsPsych.randomization.sampleExGaussian(500, 50, 0.006666666666666667, !0) +
            e.enable_button_after,
          response: this.jsPsych.randomization.randomInt(0, e.choices.length - 1),
        },
        s = this.jsPsych.pluginAPI.mergeSimulationData(i, t);
      return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e, s), s;
    }
    simulate_data_only(e, t) {
      const i = this.create_simulation_data(e, t);
      this.jsPsych.finishTrial(i);
    }
    simulate_visual(e, t, i) {
      const s = this.create_simulation_data(e, t),
        l = this.jsPsych.getDisplayElement();
      this.trial(l, e),
        i(),
        s.rt !== null &&
          this.jsPsych.pluginAPI.clickTarget(
            l.querySelector(`#jspsych-html-button-response-btngroup [data-choice="${s.response}"]`),
            s.rt
          );
    }
  }
  return (c.info = g), c;
})(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
