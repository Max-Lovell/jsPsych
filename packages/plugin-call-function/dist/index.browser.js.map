{"version":3,"file":"index.browser.js","sources":["../src/index.ts"],"sourcesContent":["import { JsPsych, JsPsychPlugin, ParameterType, TrialType } from \"jspsych\";\n\nimport { version } from \"../package.json\";\n\nconst info = <const>{\n  name: \"call-function\",\n  version: version,\n  parameters: {\n    /** The function to call. */\n    func: {\n      type: ParameterType.FUNCTION,\n      default: undefined,\n    },\n    /** Set to true if `func` is an asynchoronous function. If this is true, then the first argument passed to `func`\n     * will be a callback that you should call when the async operation is complete. You can pass data to the callback.\n     * See example below.\n     */\n    async: {\n      type: ParameterType.BOOL,\n      default: false,\n    },\n  },\n  data: {\n    /** The return value of the called function. */\n    value: {\n      type: ParameterType.COMPLEX,\n      default: undefined,\n    },\n  },\n};\n\ntype Info = typeof info;\n\n/**\n * This plugin executes a specified function. This allows the experimenter to run arbitrary code at any point during the experiment.\n *\n * The function cannot take any arguments. If arguments are needed, then an anonymous function should be used to wrap the function call (see examples below).\n *\n * @author Josh de Leeuw\n * @see {@link https://www.jspsych.org/latest/plugins/call-function/ call-function plugin documentation on jspsych.org}\n */\nclass CallFunctionPlugin implements JsPsychPlugin<Info> {\n  static info = info;\n\n  constructor(private jsPsych: JsPsych) {}\n\n  trial(display_element: HTMLElement, trial: TrialType<Info>) {\n    //trial.post_trial_gap = 0;  // TO DO: TS error: number not assignable to type any[]. I don't think this param should be an array..?\n    let return_val;\n\n    const end_trial = () => {\n      const trial_data = {\n        value: return_val,\n      };\n\n      this.jsPsych.finishTrial(trial_data);\n    };\n\n    if (trial.async) {\n      const done = (data) => {\n        return_val = data;\n        end_trial();\n      };\n      trial.func(done);\n    } else {\n      return_val = trial.func();\n      end_trial();\n    }\n  }\n\n  // no explicit simulate() mode for this plugin because it would just do\n  // the same thing as the regular plugin\n}\n\nexport default CallFunctionPlugin;\n"],"names":["version","ParameterType"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAIA,MAAM,IAAc,GAAA;EAAA,EAClB,IAAM,EAAA,eAAA;EAAA,WACNA,gBAAA;EAAA,EACA,UAAY,EAAA;EAAA,IAEV,IAAM,EAAA;EAAA,MACJ,MAAMC,qBAAc,CAAA,QAAA;EAAA,MACpB,OAAS,EAAA,KAAA,CAAA;EAAA,KACX;EAAA,IAKA,KAAO,EAAA;EAAA,MACL,MAAMA,qBAAc,CAAA,IAAA;EAAA,MACpB,OAAS,EAAA,KAAA;EAAA,KACX;EAAA,GACF;EAAA,EACA,IAAM,EAAA;EAAA,IAEJ,KAAO,EAAA;EAAA,MACL,MAAMA,qBAAc,CAAA,OAAA;EAAA,MACpB,OAAS,EAAA,KAAA,CAAA;EAAA,KACX;EAAA,GACF;EACF,CAAA,CAAA;EAYA,MAAM,kBAAkD,CAAA;EAAA,EAGtD,YAAoB,OAAkB,EAAA;EAAlB,IAAA,IAAA,CAAA,OAAA,GAAA,OAAA,CAAA;EAAA,GAAmB;EAAA,EAFvC,OAAO,IAAO,GAAA,IAAA,CAAA;EAAA,EAId,KAAA,CAAM,iBAA8B,KAAwB,EAAA;EAE1D,IAAI,IAAA,UAAA,CAAA;EAEJ,IAAA,MAAM,YAAY,MAAM;EACtB,MAAA,MAAM,UAAa,GAAA;EAAA,QACjB,KAAO,EAAA,UAAA;EAAA,OACT,CAAA;EAEA,MAAK,IAAA,CAAA,OAAA,CAAQ,YAAY,UAAU,CAAA,CAAA;EAAA,KACrC,CAAA;EAEA,IAAA,IAAI,MAAM,KAAO,EAAA;EACf,MAAM,MAAA,IAAA,GAAO,CAAC,IAAS,KAAA;EACrB,QAAa,UAAA,GAAA,IAAA,CAAA;EACb,QAAU,SAAA,EAAA,CAAA;EAAA,OACZ,CAAA;EACA,MAAA,KAAA,CAAM,KAAK,IAAI,CAAA,CAAA;EAAA,KACV,MAAA;EACL,MAAA,UAAA,GAAa,MAAM,IAAK,EAAA,CAAA;EACxB,MAAU,SAAA,EAAA,CAAA;EAAA,KACZ;EAAA,GACF;EAIF;;;;;;;;"}