var jsPsychCanvasSliderResponse = (function (a) {
  "use strict";
  var c = {
    name: "@jspsych/plugin-canvas-slider-response",
    version: "2.0.0",
    description: "jsPsych plugin for displaying a canvas stimulus and getting a slider response",
    type: "module",
    main: "dist/index.cjs",
    exports: { import: "./dist/index.js", require: "./dist/index.cjs" },
    typings: "dist/index.d.ts",
    unpkg: "dist/index.browser.min.js",
    files: ["src", "dist"],
    source: "src/index.ts",
    scripts: {
      test: "jest  --passWithNoTests",
      "test:watch": "npm test -- --watch",
      tsc: "tsc",
      build: "rollup --config",
      "build:watch": "npm run build -- --watch",
    },
    repository: {
      type: "git",
      url: "git+https://github.com/jspsych/jsPsych.git",
      directory: "packages/plugin-canvas-slider-response",
    },
    author: "Chris Jungerius, Josh de Leeuw",
    license: "MIT",
    bugs: { url: "https://github.com/jspsych/jsPsych/issues" },
    homepage: "https://www.jspsych.org/latest/plugins/canvas-slider-response",
    peerDependencies: { jspsych: ">=7.1.0" },
    devDependencies: { "@jspsych/config": "^3.0.0", "@jspsych/test-utils": "^1.2.0" },
  };
  const y = {
    name: "canvas-slider-response",
    version: c.version,
    parameters: {
      stimulus: { type: a.ParameterType.FUNCTION, default: void 0 },
      min: { type: a.ParameterType.INT, default: 0 },
      max: { type: a.ParameterType.INT, default: 100 },
      slider_start: { type: a.ParameterType.INT, default: 50 },
      step: { type: a.ParameterType.INT, default: 1 },
      labels: { type: a.ParameterType.HTML_STRING, default: [], array: !0 },
      slider_width: { type: a.ParameterType.INT, default: null },
      button_label: { type: a.ParameterType.STRING, default: "Continue", array: !1 },
      require_movement: { type: a.ParameterType.BOOL, default: !1 },
      prompt: { type: a.ParameterType.HTML_STRING, default: null },
      stimulus_duration: { type: a.ParameterType.INT, default: null },
      trial_duration: { type: a.ParameterType.INT, default: null },
      response_ends_trial: { type: a.ParameterType.BOOL, default: !0 },
      canvas_size: { type: a.ParameterType.INT, array: !0, default: [500, 500] },
    },
    data: { rt: { type: a.ParameterType.INT }, response: { type: a.ParameterType.STRING } },
  };
  class p {
    constructor(t) {
      this.jsPsych = t;
    }
    trial(t, e) {
      var s = '<div id="jspsych-canvas-slider-response-wrapper" style="margin: 100px 0px;">';
      (s +=
        '<div id="jspsych-canvas-slider-response-stimulus"><canvas id="jspsych-canvas-stimulus" height="' +
        e.canvas_size[0] +
        '" width="' +
        e.canvas_size[1] +
        '"></canvas></div>'),
        (s +=
          '<div class="jspsych-canvas-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:'),
        e.slider_width !== null ? (s += e.slider_width + "px;") : (s += e.canvas_size[1] + "px;"),
        (s += '">'),
        (s +=
          '<input type="range" class="jspsych-slider" value="' +
          e.slider_start +
          '" min="' +
          e.min +
          '" max="' +
          e.max +
          '" step="' +
          e.step +
          '" style="width: 100%;" id="jspsych-canvas-slider-response-response"></input>'),
        (s += "<div>");
      for (var i = 0; i < e.labels.length; i++) {
        var n = 100 / (e.labels.length - 1),
          l = i * (100 / (e.labels.length - 1)) - n / 2;
        (s +=
          '<div style="display: inline-block; position: absolute; left:' +
          l +
          "%; text-align: center; width: " +
          n +
          '%;">'),
          (s += '<span style="text-align: center; font-size: 80%;">' + e.labels[i] + "</span>"),
          (s += "</div>");
      }
      (s += "</div>"),
        (s += "</div>"),
        (s += "</div>"),
        e.prompt !== null && (s += e.prompt),
        (s +=
          '<button id="jspsych-canvas-slider-response-next" class="jspsych-btn" ' +
          (e.require_movement ? "disabled" : "") +
          ">" +
          e.button_label +
          "</button>"),
        (t.innerHTML = s);
      let o = document.getElementById("jspsych-canvas-stimulus");
      (o.style.display = "block"), e.stimulus(o);
      var u = { rt: null, response: null };
      const d = () => {
        var r = { rt: u.rt, response: u.response, slider_start: e.slider_start };
        this.jsPsych.finishTrial(r);
      };
      if (e.require_movement) {
        const r = () => {
          t.querySelector("#jspsych-canvas-slider-response-next").disabled = !1;
        };
        t
          .querySelector("#jspsych-canvas-slider-response-response")
          .addEventListener("mousedown", r),
          t
            .querySelector("#jspsych-canvas-slider-response-response")
            .addEventListener("touchstart", r),
          t.querySelector("#jspsych-canvas-slider-response-response").addEventListener("change", r);
      }
      t.querySelector("#jspsych-canvas-slider-response-next").addEventListener("click", () => {
        var r = performance.now();
        (u.rt = Math.round(r - m)),
          (u.response = t.querySelector("#jspsych-canvas-slider-response-response").valueAsNumber),
          e.response_ends_trial
            ? d()
            : (t.querySelector("#jspsych-canvas-slider-response-next").disabled = !0);
      }),
        e.stimulus_duration !== null &&
          this.jsPsych.pluginAPI.setTimeout(() => {
            t.querySelector("#jspsych-canvas-slider-response-stimulus").style.visibility = "hidden";
          }, e.stimulus_duration),
        e.trial_duration !== null && this.jsPsych.pluginAPI.setTimeout(d, e.trial_duration);
      var m = performance.now();
    }
    simulate(t, e, s, i) {
      e == "data-only" && (i(), this.simulate_data_only(t, s)),
        e == "visual" && this.simulate_visual(t, s, i);
    }
    create_simulation_data(t, e) {
      const s = {
          response: this.jsPsych.randomization.randomInt(t.min, t.max),
          rt: this.jsPsych.randomization.sampleExGaussian(500, 50, 0.006666666666666667, !0),
        },
        i = this.jsPsych.pluginAPI.mergeSimulationData(s, e);
      return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t, i), i;
    }
    simulate_data_only(t, e) {
      const s = this.create_simulation_data(t, e);
      this.jsPsych.finishTrial(s);
    }
    simulate_visual(t, e, s) {
      const i = this.create_simulation_data(t, e),
        n = this.jsPsych.getDisplayElement();
      if ((this.trial(n, t), s(), i.rt !== null)) {
        const l = n.querySelector("input[type='range']");
        setTimeout(() => {
          this.jsPsych.pluginAPI.clickTarget(l), (l.valueAsNumber = i.response);
        }, i.rt / 2),
          this.jsPsych.pluginAPI.clickTarget(n.querySelector("button"), i.rt);
      }
    }
  }
  return (p.info = y), p;
})(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
